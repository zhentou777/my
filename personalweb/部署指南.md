# 个人网站部署指南

本文档将指导您如何将个人网站部署到公网上供他人通过网址访问。

## 方法一：使用Docker部署（推荐）

### 前提条件
- 一台有公网IP的服务器（阿里云、腾讯云、AWS、Google Cloud等）
- 安装了Docker和Docker Compose

### 部署步骤

1. **准备服务器**
   - 确保服务器安全组/防火墙已开放5000端口

2. **上传代码到服务器**
   ```bash
   # 可以使用git或scp等方式上传代码
   git clone [您的代码仓库地址] personalweb
   cd personalweb
   ```

3. **构建并启动容器**
   ```bash
   docker-compose up -d --build
   ```

4. **验证部署**
   访问 `http://您的服务器IP:5000` 查看网站

## 方法二：传统部署方式

### 前提条件
- 一台有公网IP的服务器
- 安装了Python 3.7+和pip

### 部署步骤

1. **准备服务器**
   - 确保服务器安全组/防火墙已开放5000端口

2. **上传代码到服务器**
   ```bash
   git clone [您的代码仓库地址] personalweb
   cd personalweb
   ```

3. **创建虚拟环境并安装依赖**
   ```bash
   python3 -m venv venv
   source venv/bin/activate  # Linux/Mac
   # 或 venv\Scripts\activate  # Windows
   pip install -r requirements.txt
   ```

4. **使用Gunicorn启动应用**
   ```bash
   gunicorn app:application -w 2 -b 0.0.0.0:5000
   ```

## 域名配置（可选）

1. **购买域名**：从域名注册商（如阿里云、腾讯云、GoDaddy等）购买一个域名

2. **配置DNS解析**：将域名解析到您服务器的公网IP地址

3. **配置HTTPS（推荐）**：
   - 安装Nginx作为反向代理
   - 使用Let's Encrypt获取免费SSL证书

### Nginx配置示例

```nginx
server {
    listen 80;
    server_name yourdomain.com;
    
    # 重定向HTTP到HTTPS
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl;
    server_name yourdomain.com;
    
    # SSL配置
    ssl_certificate /etc/letsencrypt/live/yourdomain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/yourdomain.com/privkey.pem;
    
    # 代理到Flask应用
    location / {
        proxy_pass http://localhost:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

## 维护与更新

### 更新代码
```bash
# 在项目目录中
git pull
# 使用Docker方式
docker-compose up -d --build
# 或传统方式
# 重启Gunicorn服务
```

### 备份留言数据
```bash
# 备份messages.json文件
cp messages.json messages.json.bak
```

## 常见问题

1. **网站无法访问**：检查服务器防火墙设置和安全组配置
2. **留言未保存**：检查messages.json文件权限和可写性
3. **性能问题**：可以增加Gunicorn的worker数量

祝您部署顺利！